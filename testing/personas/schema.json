{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Educator Builder Persona v2.0",
  "description": "Schema for synthetic personas with emotional state tracking",
  "type": "object",
  "required": ["id", "name", "behavioral", "objectives", "conversationStyle", "termination", "opening"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9-]*$",
      "description": "Unique identifier (e.g., 'jordan-taylor')"
    },
    "name": {
      "type": "string",
      "description": "Full name of the persona"
    },
    "archetype": {
      "type": "string",
      "enum": ["seeker", "skeptic", "performer", "builder", "learner"],
      "description": "High-level behavioral category (for grouping)"
    },
    "tier": {
      "type": "string",
      "enum": ["standard", "challenging"],
      "default": "standard"
    },

    "demographics": {
      "type": "object",
      "description": "Background information for consistent persona behavior",
      "properties": {
        "age": { "type": "integer", "minimum": 18, "maximum": 80 },
        "location": { "type": "string" },
        "occupation": { "type": "string" },
        "education": { "type": "string" },
        "familySituation": { "type": "string" },
        "livingContext": { "type": "string" }
      }
    },

    "values": {
      "type": "object",
      "description": "Core values and dealbreakers",
      "properties": {
        "ranked": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Values in order of priority"
        },
        "dealbreakers": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Things that would cause immediate exit"
        }
      }
    },

    "behavioral": {
      "type": "object",
      "required": ["communicationStyle", "reasoningStyle", "authenticityLevel"],
      "properties": {
        "communicationStyle": {
          "type": "string",
          "enum": ["articulate", "exploratory", "transactional", "vague", "performative"]
        },
        "reasoningStyle": {
          "type": "string",
          "enum": ["philosophical", "practical", "systems-oriented", "surface-level"]
        },
        "authenticityLevel": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "description": "1=highly performative, 10=radically honest"
        },
        "questioningDepth": {
          "type": "string",
          "enum": ["deep-philosophical", "curious-practical", "logistics-only", "none"]
        },
        "responsePatterns": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },

    "cognitive": {
      "type": "object",
      "properties": {
        "selfAwareness": { "type": "integer", "minimum": 1, "maximum": 10 },
        "systemsThinking": { "type": "integer", "minimum": 1, "maximum": 10 },
        "valuesProfile": { "type": "array", "items": { "type": "string" } }
      }
    },

    "constraints": {
      "type": "object",
      "properties": {
        "avoidancePatterns": { "type": "array", "items": { "type": "string" } },
        "conversationalLimits": { "type": "array", "items": { "type": "string" } }
      }
    },

    "objectives": {
      "type": "object",
      "required": ["primary", "mustAnswer"],
      "properties": {
        "primary": { "type": "string" },
        "mustAnswer": { "type": "array", "items": { "type": "string" }, "minItems": 1 },
        "satisfactionSignals": { "type": "array", "items": { "type": "string" } },
        "dissatisfactionSignals": { "type": "array", "items": { "type": "string" } }
      }
    },

    "conversationStyle": {
      "type": "object",
      "required": ["promptGuidance"],
      "properties": {
        "turnStructure": {
          "type": "object",
          "properties": {
            "alwaysReactFirst": { "type": "boolean" },
            "circleBackToUnanswered": { "type": "boolean" },
            "questionsPerTurn": { "type": "string" }
          }
        },
        "promptGuidance": {
          "type": "string",
          "description": "High-level guidance for LLM to roleplay this persona"
        }
      }
    },

    "termination": {
      "type": "object",
      "required": ["minTurns", "maxTurns"],
      "properties": {
        "minTurns": { "type": "integer", "minimum": 2 },
        "maxTurns": { "type": "integer", "minimum": 3 },
        "positiveExit": { "type": "string" },
        "negativeExit": { "type": "string" },
        "neutralExit": { "type": "string" }
      }
    },

    "opening": {
      "type": "object",
      "required": ["firstMessage"],
      "properties": {
        "firstMessage": { "type": "string" },
        "initialMood": { "type": "string" }
      }
    },

    "emotionalDefaults": {
      "type": "object",
      "description": "Initial values for the 8 emotional factors (0-1 scale)",
      "properties": {
        "questionsAnswered": { "type": "number", "minimum": 0, "maximum": 1 },
        "feltHeard": { "type": "number", "minimum": 0, "maximum": 1 },
        "trust": { "type": "number", "minimum": 0, "maximum": 1 },
        "engagement": { "type": "number", "minimum": 0, "maximum": 1 },
        "frustration": { "type": "number", "minimum": 0, "maximum": 1 },
        "connection": { "type": "number", "minimum": 0, "maximum": 1 },
        "goalProgress": { "type": "number", "minimum": 0, "maximum": 1 },
        "novelty": { "type": "number", "minimum": 0, "maximum": 1 }
      }
    },

    "emotionalInertia": {
      "type": "object",
      "description": "How much previous emotional state persists (0-1). Higher = slower to change.",
      "properties": {
        "positive": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.4 },
        "negative": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.6 }
      }
    },

    "reactionWeights": {
      "type": "object",
      "description": "How LLM reactions affect emotional factors. Keys are reaction flags, values are factor deltas.",
      "additionalProperties": {
        "type": "object",
        "additionalProperties": { "type": "number" }
      }
    },

    "decayRates": {
      "type": "object",
      "description": "Per-turn decay for factors (negative values)",
      "properties": {
        "engagement": { "type": "number" },
        "novelty": { "type": "number" }
      }
    },

    "exitThresholds": {
      "type": "object",
      "description": "Conditions and probabilities for each exit type",
      "properties": {
        "satisfied": {
          "type": "object",
          "properties": {
            "conditions": { "type": "object", "additionalProperties": { "type": "number" } },
            "probability": { "type": "number", "minimum": 0, "maximum": 1 }
          }
        },
        "frustrated": {
          "type": "object",
          "properties": {
            "conditions": { "type": "object", "additionalProperties": { "type": "number" } },
            "probability": { "type": "number", "minimum": 0, "maximum": 1 }
          }
        },
        "bored": {
          "type": "object",
          "properties": {
            "conditions": { "type": "object", "additionalProperties": { "type": "number" } },
            "probability": { "type": "number", "minimum": 0, "maximum": 1 }
          }
        },
        "disconnected": {
          "type": "object",
          "properties": {
            "conditions": { "type": "object", "additionalProperties": { "type": "number" } },
            "probability": { "type": "number", "minimum": 0, "maximum": 1 }
          }
        },
        "ghosted": {
          "type": "object",
          "properties": {
            "conditions": { "type": "object", "additionalProperties": { "type": "number" } },
            "minTurn": { "type": "integer" },
            "probability": { "type": "number", "minimum": 0, "maximum": 1 }
          }
        }
      }
    },

    "exitBehavior": {
      "type": "object",
      "description": "Probability of generating exit message for each exit type",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "probability": { "type": "number", "minimum": 0, "maximum": 1 }
        }
      }
    },

    "targetRubricDimensions": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Rubric criteria this persona tests"
    },

    "expectedDialogueActs": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Dialogue acts this persona should elicit"
    },

    "testingNotes": {
      "type": "string",
      "description": "Why this persona exists and what it validates"
    }
  }
}
